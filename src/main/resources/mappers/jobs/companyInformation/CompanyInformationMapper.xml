<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kh.workPeople.jobs.companyInformation.model.dao.CompanyInformationMapper">
	<resultMap type="com.kh.workPeople.jobs.companyInformation.model.vo.CompanyDetailInformation" id="companyDetailInformationResultMap">
		<result property="companyName" column="COMPANY_NAME"/>
		<result property="address" column="ADDRESS"/>
		<result property="interestedCount" column="INTERESTED_COUNT"/>
		<result property="interestedCompany" column="INTERESTED"/>
		<association property="companyInformation" resultMap="Common.companyResultMap"/>
	</resultMap>
	<select id="getCompanyDetailInformation" parameterType="hashmap" resultMap="companyDetailInformationResultMap">
		SELECT 
		       COMPANY_NAME
		     , ADDRESS
		     , COMPANY_INFORMATION.CI_NO
		     , CI_CEONAME
		     , CI_FOUNDING_DATE
		     , CI_EMPLOYEE_NUMBER
		     , CI_BUSINESS_DETAIL
		     , CI_COMPANY_HISTORY
		     , CI_COMPANY_VISION
		     , CI_HOMEPAGE
		     , A_NO
		     , A_ORIGIN_NAME
		     , A_CHANGE_NAME
		     , A_FILE_PATH
		     , A_STATUS
		     , A_CREATE
		     , S_NO
		     , S_NAME
		     , CT_NO
		     , CT_NAME
		     , INTERESTED_COUNT
		   <if test="userNo != null">
		     , CASE
		        WHEN INTERESTED_COMPANY.CI_NO IS NULL THEN 'N'
		        ELSE 'Y'
		       END INTERESTED
		   </if>
		  FROM COMPANY_INFORMATION
		  <if test="userNo != null">
		  LEFT OUTER JOIN (SELECT CI_NO
	      		             FROM INTERESTED_COMPANY
	                        WHERE M_NO = #{userNo}) INTERESTED_COMPANY ON(COMPANY_INFORMATION.CI_NO = INTERESTED_COMPANY.CI_NO)
	      </if>
		 WHERE COMPANY_INFORMATION.CI_NO = #{companyInformationNo}
	</select>
</mapper>